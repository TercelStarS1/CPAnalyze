<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>欢迎进入系统</title>
    <meta name="description" content="particles.js is a lightweight JavaScript library for creating particles.">
    <meta name="author" content="Vincent Garreau" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" media="screen" href="ResourceYC/login/css/style.css">
    <link rel="stylesheet" type="text/css" href="ResourceYC/login/css/reset.css" />
</head>
<body>

    <div id="particles-js">
        <div class="login" style="">
            <div class="login-top" > 
                <img style="margin-left:95px;margin-top:-70px;"  src="ResourceYC/login/img/zd.jpg" width="80" />
                <p>欢迎使用饲养预测分析系统</p>
            </div>
            <div class="login-center clearfix">
                <div class="login-center-img"><img src="ResourceYC/login/img/name.png" /></div>
                <div class="login-center-input">
                    <input type="text" name="" id="txtname" value="" placeholder="请输入您的用户名" onfocus="this.placeholder=''" onblur="this.placeholder='请输入您的用户名'" />
                    <div class="login-center-input-text">用户名</div>
                </div>
            </div>
            <div class="login-center clearfix">
                <div class="login-center-img"><img src="ResourceYC/login/img/password.png" /></div>
                <div class="login-center-input">
                    <input type="password" name="" id="txtpwd" value="" placeholder="请输入您的密码" onfocus="this.placeholder=''" onblur="this.placeholder='请输入您的密码'" />
                    <div class="login-center-input-text">密码</div>
                </div>
            </div>
            <div class="login-button">
                登录
            </div>
        </div>
        <div class="sk-rotating-plane"></div>
    </div>

    <!-- scripts -->

    <script src="ResourceYC/plugins/jQuery/jquery-2.2.3.min.js"></script>
    <script src="ResourceYC/plugins/jquery.cookie.js"></script> 
    <script src="ResourceYC/login/js/particles.min.js"></script>
    <script src="ResourceYC/login/js/app.js"></script>
    <script type="text/javascript">
	function hasClass(elem, cls) {
	  cls = cls || '';
	  if (cls.replace(/\s/g, '').length == 0) return false; //当cls没有参数时，返回false
	  return new RegExp(' ' + cls + ' ').test(' ' + elem.className + ' ');
	}

	function addClass(ele, cls) {
	  if (!hasClass(ele, cls)) {
	    ele.className = ele.className == '' ? cls : ele.className + ' ' + cls;
	  }
	}

	function removeClass(ele, cls) {
	  if (hasClass(ele, cls)) {
	    var newClass = ' ' + ele.className.replace(/[\t\r\n]/g, '') + ' ';
	    while (newClass.indexOf(' ' + cls + ' ') >= 0) {
	      newClass = newClass.replace(' ' + cls + ' ', ' ');
	    }
	    ele.className = newClass.replace(/^\s+|\s+$/g, '');
	  }
	}
	localStorage.setItem('bottomhtmlYC', "");   //导航栏内容
	localStorage.setItem('headerhtmlYC', "");   //修改密码弹窗
	localStorage.setItem('dhcontentYC', "");    //菜單欄
	if (!localStorage.getItem("bottomhtmlYC")) {  //<footer class='main-footer'><div class='pull-right hidden-xs'><b>Version</b> 1.0.0</div><strong>Copyright &copy; 2018-2020 <a href='#'>正大东南十省</a>.</strong> All rights reserved.</footer>
	    var bottomhtml = "<aside class='control-sidebar control-sidebar-dark'><ul class='nav nav-tabs nav-justified control-sidebar-tabs'><li><a href='#control-sidebar-home-tab' data-toggle='tab'><i class='fa fa-home'></i></a></li></ul><div class='tab-content'><div class='tab-pane' id='control-sidebar-home-tab'></div></div></aside><div class='control-sidebar-bg'></div><script src='../ResourceYC/dist/js/demo.js'>";
	    localStorage.setItem('bottomhtmlYC', bottomhtml);
	} 
	if (!localStorage.getItem("headerhtmlYC")) {
	    var headerhtml = "<header class='main-header'><a href='Start.html' class='logo'> <span class='logo-mini'><img style='width:35px;' src='../ResourceYC/login/img/zd.jpg' /></span> <span class='logo-lg'><img style='width:35px;' src='../ResourceYC/login/img/zd.jpg' /><b> 项目</b>风险分析</span></a><nav class='navbar navbar-static-top'><a href='#' class='sidebar-toggle' data-toggle='offcanvas' role='button'><span class='sr-only'>Toggle navigation</span></a><div class='navbar-custom-menu'><ul class='nav navbar-nav'><li class='dropdown user user-menu'><a href='#' class='dropdown-toggle' data-toggle='dropdown'><img src='../ResourceYC/dist/img/user2-160x160.jpg' class='user-image' alt='User Image'><span class='hidden-xs' id='loginUser'></span></a><ul class='dropdown-menu'><li class='user-footer'><div class='pull-left'><a href='#' data-toggle='modal' data-target='#changePWD' class='btn btn-default btn-flat'>修改密码</a></div><div class='pull-right'><a href='../index.html' class='btn btn-default btn-flat'>退出系统</a></div></li></ul></li><li><a href='#' data-toggle='control-sidebar'><i class='fa fa-gears'></i></a></li></ul></div></nav></header><aside class='main-sidebar' id='dhdiv'></aside> ";
	    localStorage.setItem('headerhtmlYC', headerhtml);
	}
	if (!localStorage.getItem('dhcontentYC')) {
	    var dh = "<section class='sidebar'> " +
                                "    <ul class='sidebar-menu'> " +
                                "        <li class='treeview'> " +
                                "            <a href='#'><i class='fa fa-star'></i> <span>项目风险预测</span> <span class='pull-right-container'> <i class='fa fa-angle-left pull-right'></i> </span></a>" +
                                "            <ul class='treeview-menu'> " +
                                "                <li> <a href='Start.html'><i class='fa fa-circle-o'></i>猪类预测</a> </li> " +
                                "            </ul> " +
                                "        </li> " +
                                "    </ul> " +
                                "</section>";
	    localStorage.setItem('dhcontentYC', dh);
	} 
         
	localStorage.setItem('changepwdYC', "");   //修改密码弹窗
	localStorage.setItem('loginUserYC', "");   //登陆用户信息  
	$.cookie('loginUserYC', "");
	$(".login-button").click(function () {
	    var username = $("#txtname").val();
	    var userpwd = $("#txtpwd").val();
	    console.log(username, userpwd);
	    $.ajax({
	        type: "Post",
	        url: "/api/Account/UserLoginYC",
	        dataType: 'json',
	        data: { CODE: username, PASSWORD: userpwd },
	        success: function (data) {  
	            if (data.num == 1) {
	                alert("用户名或密码错误，请重新输入");
	                removeClass(document.querySelector(".login"), "active")
	                removeClass(document.querySelector(".sk-rotating-plane"), "active")
	                document.querySelector(".login").style.display = "block"
	            }
	            else {
	                if (username =="admin") {
	                    var dh = "<section class='sidebar'> " +
                               "    <ul class='sidebar-menu'> " +
                               "        <li class='treeview'> " +
                               "            <a href='#'><i class='fa fa-star'></i> <span>项目风险预测</span> <span class='pull-right-container'> <i class='fa fa-angle-left pull-right'></i> </span></a>" +
                               "            <ul class='treeview-menu'> " +
                               "                <li> <a href='Start.html'><i class='fa fa-circle-o'></i>猪类预测</a> </li> " +
                               "            </ul> " +
                               "        </li> " +
                               "        <li class='treeview'> " +
                               "            <a href='#'><i class='fa fa-database'></i> <span>基础数据管理</span> <span class='pull-right-container'> <i class='fa fa-angle-left pull-right'></i> </span></a>" +
                               "            <ul class='treeview-menu'> " +
                               "                <li> <a href='FeedPage.html'><i class='fa fa-circle-o'></i>饲料管理</a> </li> " +
                               "                <li> <a href='VaccinePage.html'><i class='fa fa-circle-o'></i>疫苗管理</a> </li> " +
                               "                <li> <a href='BasicDataPage.html'><i class='fa fa-circle-o'></i>基本数据管理</a> </li> " +
                               "                <li> <a href='GrowPage.html'><i class='fa fa-circle-o'></i>生长标准管理</a> </li> " +
                               "            </ul> " +
                               "        </li> " +
                               "    </ul> " +
                               "</section>";
	                    localStorage.setItem('dhcontentYC', dh);
	                }
	                var changepwd = "<div class='modal fade' id='changePWD' tabindex='-1' role='dialog' aria-labelledby='myModalLabel' aria-hidden='true'><div class='modal-dialog' style='margin-top:120px;'><div class='modal-content'><div class='modal-header'> <button type='button' class='close' data-dismiss='modal' aria-hidden='true'> &times; </button><h4 class='modal-title' id='myModalLabel'> 修改密码  </h4> </div><div class='modal-body' style='width:80%; margin-left:20px;'><div style='height:45px;'><label class='col-sm-3'>旧密码 <span class='require'>*</span></label><div class='col-sm-9'><div class='input-group'><span class='input-group-addon'><i class='fa fa-key'></i></span><input type='text' id='oldpwd' class='form-control' /></div> </div></div><div style='height:45px;'><label class='col-sm-3'>新密码 <span class='require'>*</span></label><div class='col-sm-9'><div class='input-group'><span class='input-group-addon'><i class='fa fa-key'></i></span><input type='text' id='newpwd' class='form-control' /></div> </div></div><div style='height:45px;'><label class='col-sm-3'>确认密码 <span class='require'>*</span></label><div class='col-sm-9'><div class='input-group'><span class='input-group-addon'><i class='fa fa-key'></i></span><input type='text' id='newpwdc' class='form-control' /></div> </div></div></div><div class='modal-footer'><button type='button' class='btn btn-default' data-dismiss='modal'> 关闭 </button><button type='button' id='btnChangePwd' class='btn btn-primary'> 提交更改 </button></div></div> </div></div>";
	                localStorage.setItem('changepwdYC', changepwd);
	                localStorage.setItem('loginUserYC', data.skin);  //顯示用戶名
	                $.cookie('loginUserYC', data.data); 
	                setTimeout(function () {
	                    removeClass(document.querySelector(".login"), "active")
	                    removeClass(document.querySelector(".sk-rotating-plane"), "active")
	                    document.querySelector(".login").style.display = "block"
	                    window.location.href = "PageYC/Start.html"
	                }, 1500)
	            } 
	        }
	    });

	    addClass(document.querySelector(".login"), "active")
	    setTimeout(function () {
	        addClass(document.querySelector(".sk-rotating-plane"), "active")
	        document.querySelector(".login").style.display = "none"
	    }, 600)  
	}); 
    </script>
</body>
</html>